<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE pkgmetadata SYSTEM "http://www.gentoo.org/dtd/metadata.dtd">
<pkgmetadata>
	<maintainer type="person">
		<email>gentoo@houseofsuns.org</email>
		<name>Markus Walter</name>
	</maintainer>
	<longdescription># Mixed development source packages on top of stable constraints using pip*mxdev* [mɪks dɛv] is a utility that makes it easy to work with Python projects containing lots of packages, of which you only want to develop some.It builds on top of the idea to have stable version constraints and then develop from a VCS on top of it.As part of the above use-case sometimes versions of the stable constraints need an override with a different (i.e. newer) version.Other software follow the same idea are [mr.developer](https://pypi.org/project/mr.developer)  for Python's *zc.buildout* or [mrs-developer](https://www.npmjs.com/package/mrs-developer) for NPM packages.**mxdev 2.0 needs pip version 22 at minimum to work properly**### Overviewmxdev procedure is:1. Configuration is read,2. Requirements and constraints (given in the configuration) are read.3. Sources from VCS are fetched into a target directory,4. Modified constraints (handled packages commented, overridden versions replaced) and requirements (handled packages as editable from sources) are written.mxdev will **not** run *pip* for you!### ConfigurationGiven a `requirements.txt` (or similar named) file which itself references a `constraints.txt` file inside.Create an INI file, like `mx.ini` in [configparser.ExtendedInterpolation](https://docs.python.org/3/library/configparser.html#configparser.ExtendedInterpolation) syntax.### Main section `[settings]`The **main section** must be called `[settings]`, even if kept empty.In the main sections the input and output files are defined.#### `requirements-in`Main requirements file to start with. This can be an URL too.If given an empty value mxdev will only generate output from the information given in INI file itself.Default: `requirements.txt`#### `requirements-out`Output of the combined requirements including development sources to be used later with `pip install`.Default: `requirements-mxdev.txt`#### `constraints-out`Output of the combined constraints.Default: `constraints-mxdev.txt`#### `default-target`Target directory for sources from VCS. Default: `./sources`#### `default-install-mode`Default for `install-mode` on section, read there for detailsAllowed values: `direct` or `skip`Default: `direct`#### `default-update`Default for `update` on section, read there for detailsAllowed values: `yes` or `no`Default: `yes`#### `threads`Number of threads to fetch sources in parallel with.Speeds up fetching from VCS.Default: `4`#### `offline`Do not fetch any sources.Handy if working offline.Default: `False`#### `version-overrides`Override package versions which are already defined in a dependent constraints file.I.e. an upstream *constraints.txt* contains already `somefancypackage==2.0.3`.Given that, for some reason (like with my further developed sources), we need version 3.0.0 of the above package.Then in this section, this can be defined as:```INI[settings]version-overrides =    somefancypackage==3.0.0    otherpackage==33.12.1```It is possible to add as many overrides as needed.When writing the *constraints-out*, the new version will be taken into account.If there is a source section defined for the same package, the source will be used and entries here are ignored.#### `ignores`Ignore packages that are already defined in a dependent constraints file.No new version will be provided.This is specifically handy if a package is going to be installed editable from local file system (like `-e .`), but was already pinned in an upstream constraints file.This can be defined as:```INI[settings]ignores =    somefancypackage    otherpackage```#### `default-use`True by default.  When false, the source is not checked out,and the version for this package is not overridden.Additionally, custom variables can be defined as `key = value` pair.Those can be referenced in other values as `${settings:key}` and will be expanded there.#### `main-package`mxdev can handle one Python package as main package directly via ini config.If defined, it will be added as last entry in the resulting requirements out file.This can be defined as:```INI[settings]main-package = -e .[test]```### Subsequent package source sectionsAll other sections are defining the sources to be used.#### `[PACKAGENAME]`The section name is the package name.#### `url = URL`The checkout URL of the repository.The URL is required.#### `pushurl = URL`Optional a writable URL for pushes can be specified.If the `pushurl` is set after initial checkout it is not applied.To apply it remove the repository and checkout again.#### `branch = BRANCHNAME_OR_TAG`The branch name or tag to checkout.Defaults to `main`.#### `extras = EXTRA1,EXTRA2`Package extras to install. Default empty.#### `subdirectory = SUBPATH`For specifying the path to the Python package, when it is not in the root of the VCS directory.Default empty.#### `target`The target directory for source from this section.Default to default target directory configured in the main section `[settings]` `default-target =` value.#### `install-mode`There are different modes of pip installation##### `skip`Do not install with pip, just clone/update the repository##### `direct`Install the package using `pip -e PACKAGEPATH`.Dependencies are resolved immediatelyDefaults to default mode configured in main section `[settings]` `default-install-mode =` value.#### `use`True by default, unless `default-use` in the general settings is false.When false, the source is not checked out,and the version for this package is not overridden.#### `submodules`There are 3 different options:##### `always`(default) git submodules will always be checked out, they will be updated if already presen##### `checkout`submodules get only fetched during checkout, existing submodules stay untouche##### `recursive`Fetches submodules recursively, results in `git clone --recurse-submodules on` checkout and `submodule update --init --recursive` on update.### UsageRun `mxdev` (for more options run `mxdev --help`).Mxdev will1. **read** the configuration from `mx.ini`,2. **fetch** the packages defined in the config file and3. **write** a requirements and constraints file.Now, use the generated requirements and constraints files with i.e. `pip install -r requirements-mxdev.txt`.## Example Configuration### Example `mx.ini`This looks like so:```INI[settings]requirements-in = requirements.txtrequirements-out = requirements-mxdev.txtcontraints-out = constraints-mxdev.txtversion-overrides =    baz.baaz = 1.9.32ignores =    my.ignoredpackage# custom variablesgithub = git+ssh://git@github.com/mygit = git+ssh://git@git.kup.tirol/[foo.bar]url = ${settings:github}orga/foo.bar.gitbranch = fix99extras = test,baz[kup.fancyproject]url = ${settings:mygit}customers/fancycorp/kup.fancyproject.gitbranch = fix99extras = test,baz```### Examples at GitHub- [&quot;new&quot; plone.org backend](https://github.com/plone/plone.org/tree/main/backend)- [Conestack](https://github.com/conestack/conestack/)- (add more)## ExtendingThe functionality of mxdev can be extended by hooks.This is useful to generate additional scripts or files or automate any other setup steps related to mxdev's domain.Extension configuration settings end up in the `mx.ini` file.They can be added globally to the `settings` section, as dedicated config sections or package specific.To avoid naming conflicts, all hook-related settings and config sections must be prefixed with a namespace.It is recommended to use the package name containing the hook as a namespace.This looks like so:```INI[settings]myextension-global_setting = 1[myextension-section]setting = value[foo.bar]myextension-package_setting = 1```The extension is implemented as a subclass of `mxdev.Hook`:```Pythonfrom mxdev import Hookfrom mxdev import Stateclass MyExtension(Hook):    namespace = None    &quot;&quot;&quot;The namespace for this hook.&quot;&quot;&quot;    def read(self, state: State) -&gt; None:        &quot;&quot;&quot;Gets executed after mxdev read operation.&quot;&quot;&quot;    def write(self, state: State) -&gt; None:        &quot;&quot;&quot;Gets executed after mxdev write operation.&quot;&quot;&quot;```The default settings section from the INI file is available at `state.configuration.settings`.The package configuration is available at `state.configuration.packages`.Hook-related config sections are available at `state.configuration.hooks`.The hook must be registered as an entry point in the `pyproject.toml` of your package:```TOML[project.entry-points.mxdev]hook = &quot;myextension:MyExtension&quot;```## Rationale### ProblemThere is a constraint file like `-c constraints.txt` with a package `foo.bar` with a version pin.Then it is not possible to install this package in a requirements file editable like `-r requirements.txt` with `-e git+ssh://git@github.com/orga/foo.bar.git@fix-99`.Neither it is possible to override inherited version constraints with custom ones.### IdeaA pre-processor fetches (as this can be an URL) and expands all `-c SOMEOTHER_FILE_OR_URL` and `-r SOMEOTHER_FILE_OR_URL` files into one, filtering out all packages given in a configuration file.For each of those packages, a `-`e ...` entry is generated instead and written to a new `TARGET.txt`.Same is true for version overrides: a new entry is written to the resulting constraints file while the original version is disabled.The configuration is read from a file `mx.ini` in *ExtendedInterpolation* INI syntax (YAML would be nice, but the package must have as less dependencies as possible to other packages).### TriviaMx (generally pronounced like mix [mɪks], or [məks] in the UK) is meant to be a gender-neutral alternative to the titles Mr. and Ms. but also associates with the word &quot;mix&quot;.## MiscThe VCS-related code is taken from `mr.developer`.Thanks to Florian Schulze and Contributors.## ContributingIf you want to help with the development (improvement, update, bug-fixing, ...) of `mxdev` this is a great idea!The code is located in the [GitHub MXStack Organization / mxdev](https://github.com/mxstack/mxdev).You can fork it, work on the project and create a pull request.Maintainers are Jens Klein and the [BlueDynamics Alliance](https://bluedynamics.com) developer team.We appreciate any contribution! If you have an idea, found a bug, want to drop us a question, or a release is needed, please just file an issue at the [mxdev issue tracker](https://github.com/bluedynamics/mxdev/issues).## Changes### 3.0.0 (2023-05-08)- Removed leftover print [jensens]### 3.0.0b3 (2023-04-23)- Fix usage of `--install-option='pre'` and use `--pre` option in requirements files instead.  The install options are deprecated in pip 23 which Plone switched to recently.  More info:  https://github.com/pypa/pip/issues/11358  https://discuss.python.org/t/passing-command-line-arguments-to-pip-install-after-install-options-deprecation/22981/6  [thet, fredvd]- Fix reading sections from the config parser without defaults if the section contains a setting that also exists as default.  [rnix]- Do not write constraints out to the file if no constraints are defined.  [rnix]- Add the `main-package` option to the settings.  [rnix]### 3.0.0b2 (2023-02-07)- In this package, use `pyproject.toml` and markdown for README et al.  [jensens]- Add `use` option to sources, and `default-use` to the settings.  `default-use` is true by default.  When false, the source is not checked out, and the version for this package is not overridden.  [maurits]### 3.0.0b1 (2022-11-21)- Do not use `libvcs`, but recycled and updated (type hints, tests) `mr.developer` VCS code.  Code for GIT is tested well, code for SVN, Mercurial, Bazaar and DARCS needs contributors with knowledge in this area.  Additional options, like `pushurl`, ... (see README) were added.  `pip` style VCS URLs are not supported any longer.  [jensens, rnix, zworkb]- Config parser options are now considered case-sensitive.  [rnix]- Do not fail `mxdev` run if `requirements.txt` is missing.  [rnix]- Add flag to only fetch repositories and skip generating files.  [rnix]- Add flag to skip fetching of repositories.  [rnix]- Add support for custom hooks.  [rnix]- Rename `sources.ini` to `mx.ini` in the documentation.  [rnix]- Introduce state object and pass it to read/fetch/write.  State object contains all required runtime data.  [rnix]### 2.0.0 (2022-01-31)- Depend on pip 22, where interdependency mode is no longer needed.  Remove all interdependency-related code.  [jensens]- Better error message if the requirements-in file does not exist.  [jensens]- Better last message with the full pip command.  [jensens]- Allow empty `requirements-in` configuration.  [jensens]### 1.1.0 (2021-12-29)- Feature: Ignore existing constraints.  New setting `ignores` with a list of packages (one per line) to ignore constraints without providing a version.  [jensens]### 1.0.1 (2021-12-21)- Fix: If a developed package depends on another developed package the dependent package was ignored *sometimes* (!?).  Instead, the last release was taken.  Solution: Install it with the `--pre` option in order to allow the other non-final/in-development *release*.  [jensens]### 1.0.0 (2021-12-12)- Defaults for &quot;outfiles&quot; are `*-mxdev.txt` now.  [jensens]### 1.0.0b4 (2021-12-07)- Fix interdependency mode.  [jensens]### 1.0.0b3 (2021-12-07)- Fix: Do not apply override disabling on requirements.  [jensens]### 1.0.0b2 (2021-12-07)- Add feature: version overrides.  [jensens]### 1.0.0b1 (2021-12-04)- Add `-s` or `--silent` option.  [jensens]- Beautified output.  [jensens]- Fixed missing CR if `*.txt` does not end with a newline.  [jensens]### 1.0.0a9 (2021-12-01)- Added auto correction for pip URLs, so that GitHub or GitLab URLs can be used as copied in `sources.ini`.  [zworkb]### 1.0.0a8 (2021-11-30)- Added interdependency handling to avoid manual dependency order resolution.  [jensens, gogobd]- Added skip mode to exclude packages from installation (clone/update only).  [jensens, gogobd]- Removed position feature.  [jensens, gogobd]### 1.0.0a7 (2021-11-30)- Removed Workaround for libvcs and depend on libvcs&gt;=0.10.1.  [jensens]### 1.0.0a6 (2021-11-30)- Workaround for libvcs bug https://github.com/vcs-python/libvcs/issues/295  [jensens, gogobd]### 1.0.0a5 (2021-11-30)- Workaround for libvcs bug https://github.com/vcs-python/libvcs/issues/293  [jensens, gogobd]### 1.0.0a4 (2021-11-29)- Fix: editable can be configured to be processed before or after initial requirements.  [jensens]### 1.0.0a3 (2021-11-23)- Fix #1: Re-run of pip vanishes committed changes  [jensens]### 1.0.0a2 (2021-11-21)- Fix/simplify packaging.  [jensens]- Implement subdirectory editable install  [jensens]- Implement package extras  [jensens]### 1.0.0a1 (2021-11-21)- Initial work.  [jensens]## LicenseCopyright (c) 2022-2023, mxstack ContributorsAll rights reserved.Redistribution and use in source and binary forms, with or withoutmodification, are permitted provided that the following conditions are met:* Redistributions of source code must retain the above copyright notice, this  list of conditions and the following disclaimer.* Redistributions in binary form must reproduce the above copyright notice, this  list of conditions and the following disclaimer in the documentation and/or  other materials provided with the distribution.THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS &quot;AS IS&quot; ANDANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIEDWARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE AREDISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE LIABLE FORANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES(INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED ANDON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT(INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THISSOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.</longdescription>
</pkgmetadata>