<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE pkgmetadata SYSTEM "http://www.gentoo.org/dtd/metadata.dtd">
<pkgmetadata>
	<maintainer type="person">
		<email>gentoo@houseofsuns.org</email>
		<name>Markus Walter</name>
	</maintainer>
	<longdescription># gevent-wsA fast, MIT-licensed alternative to the abandoned non-free (as in freedom) [gevent-websocket](https://gitlab.com/noppo/gevent-websocket).## Why?It's MIT-licensed, so it can be included to almost all software (both open-source and closed-source) without any licensing issues, as opposed to *gevent-websocket*. And it's several times faster!## Installation*gevent-ws* can be installed from PyPI and GitHub.### PyPI```shell$ pip3 install gevent-ws```### GitHub```shell$ git clone https://github.com/imachug/gevent-ws.git$ cd gevent-ws$ python3 setup.py install```## Example### A simple echo server```python3from gevent.pywsgi import WSGIServerfrom gevent_ws import WebSocketHandlerdef app(env, start_response):    ws = env[&quot;wsgi.websocket&quot;]    while True:        msg = ws.receive()        if msg is None:            break        ws.send(msg)    return [b&quot;Bye&quot;]server = WSGIServer((&quot;&quot;, 8080), app, handler_class=WebSocketHandler)server.serve_forever()```### Both HTTP and websocket on a single port```python3from gevent.pywsgi import WSGIServerfrom gevent_ws import WebSocketHandlerdef app(env, start_response):    if &quot;wsgi.websocket&quot; in env:        ws = env[&quot;wsgi.websocket&quot;]        while True:            msg = ws.receive()            if msg is None:                break            ws.send(msg)        return [b&quot;Bye&quot;]    else:        start_response(&quot;200 OK&quot;, [            (&quot;Content-Type&quot;, &quot;text/html, charset=utf-8&quot;)        ])        return [            b&quot;&quot;&quot;                &lt;script&gt;                    const ws = new WebSocket(&quot;ws://127.0.0.1:8080/&quot;);                    ws.onopen = () =&gt; {                        ws.send(&quot;Hello, world!&quot;);                    };                    ws.onmessage = e =&gt; {                        ws.send(e.data);                    };                &lt;/script&gt;            &quot;&quot;&quot;        ]server = WSGIServer((&quot;&quot;, 8080), app, handler_class=WebSocketHandler)server.serve_forever()```## Docs### `gevent_ws.WebSocketHandler`The main class. Pass it to `gevent.pywsgi.WSGIServer` as `handler_class`.### `gevent_ws.WebSocket`You get this object by accessing `wsgi.websocket` property of the environment object. If it exists, it's a websocket connection; if it doesn't, it's an HTTP request. You can use `&quot;wsgi.websocket&quot; in env` to check this and route the request correctly.### `gevent_ws.WebSocket.receive()`Waits for a message and returns it, either as `str` or `bytes`. Blocks. May return `None` if the connection is closed or an `OSError` if the socket can't be read from.### `gevent_ws.WebSocket.receive_nowait()`Returns the message if it's available (the format is the same as in `receive()`) or `None` if no message is in the queue. May return `None` or raise `OSError` (see `receive()`).### `gevent_ws.WebSocket.send(message)`Sends a message to the other party. `message` can be either `str` or `bytes`. May raise `EOFError` if the connection is closed or `OSError` if the message can't be sent for some other reason.### `gevent_ws.WebSocket.close(status=1000)`Closes the websocket. Status `1000` (the default one) means that the connection is closed cleanly. Check [RFC](https://tools.ietf.org/html/rfc6455#section-7.4) for more status codes.### `gevent_ws.WebSocket.set_max_message_length(length)`Set maximum incoming message size (in bytes). 10 MiB is the default value.### `gevent_ws.WebSocket.closed`A boolean showing whether the connection is closed (by any of the two parties) or is being closed.### `gevent_ws.WebSocket.status`The close status code sent by the other party. `None` if the socket was closed by the client, the server didn't return the error code or the connection was aborted abnormally.</longdescription>
</pkgmetadata>