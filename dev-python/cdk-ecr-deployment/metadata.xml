<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE pkgmetadata SYSTEM "http://www.gentoo.org/dtd/metadata.dtd">
<pkgmetadata>
	<maintainer type="person">
		<email>gentoo@houseofsuns.org</email>
		<name>Markus Walter</name>
	</maintainer>
	<longdescription># cdk-ecr-deployment[![Release](https://github.com/cdklabs/cdk-ecr-deployment/actions/workflows/release.yml/badge.svg)](https://github.com/cdklabs/cdk-ecr-deployment/actions/workflows/release.yml)[![npm version](https://img.shields.io/npm/v/cdk-ecr-deployment)](https://www.npmjs.com/package/cdk-ecr-deployment)[![PyPI](https://img.shields.io/pypi/v/cdk-ecr-deployment)](https://pypi.org/project/cdk-ecr-deployment)[![npm](https://img.shields.io/npm/dw/cdk-ecr-deployment?label=npm%20downloads)](https://www.npmjs.com/package/cdk-ecr-deployment)[![PyPI - Downloads](https://img.shields.io/pypi/dw/cdk-ecr-deployment?label=pypi%20downloads)](https://pypi.org/project/cdk-ecr-deployment)CDK construct to synchronize single docker image between docker registries.⚠️ Version 1.* is no longer supported, as CDK v1 has reached the end-of-lifestage. Please use only ^2.0.0.## Features* Copy image from ECR/external registry to (another) ECR/external registry* Copy an archive tarball image from s3 to ECR/external registry## Environment variablesEnable flags: `true`, `1`. e.g. `export CI=1`* `CI` indicate if it's CI environment. This flag will enable building lambda from scratch.* `NO_PREBUILT_LAMBDA` disable using prebuilt lambda.* `FORCE_PREBUILT_LAMBDA` force using prebuilt lambda.⚠️ If you want to force using prebuilt lambda in CI environment to reduce build time. Try `export FORCE_PREBUILT_LAMBDA=1`.⚠️ The above flags are only available in cdk-ecr-deployment 2.x.## Examples```pythonfrom aws_cdk.aws_ecr_assets import DockerImageAssetimage = DockerImageAsset(self, &quot;CDKDockerImage&quot;,    directory=path.join(__dirname, &quot;docker&quot;))# Copy from cdk docker image asset to another ECR.ecrdeploy.ECRDeployment(self, &quot;DeployDockerImage1&quot;,    src=ecrdeploy.DockerImageName(image.image_uri),    dest=ecrdeploy.DockerImageName(f&quot;{cdk.Aws.ACCOUNT_ID}.dkr.ecr.us-west-2.amazonaws.com/my-nginx:latest&quot;))# Copy from docker registry to ECR.ecrdeploy.ECRDeployment(self, &quot;DeployDockerImage2&quot;,    src=ecrdeploy.DockerImageName(&quot;nginx:latest&quot;),    dest=ecrdeploy.DockerImageName(f&quot;{cdk.Aws.ACCOUNT_ID}.dkr.ecr.us-west-2.amazonaws.com/my-nginx2:latest&quot;))# Copy from private docker registry to ECR.# The format of secret in aws secrets manager must be plain text! e.g. &lt;username&gt;:&lt;password&gt;ecrdeploy.ECRDeployment(self, &quot;DeployDockerImage3&quot;,    src=ecrdeploy.DockerImageName(&quot;javacs3/nginx:latest&quot;, &quot;username:password&quot;),    # src: new ecrdeploy.DockerImageName('javacs3/nginx:latest', 'aws-secrets-manager-secret-name'),    # src: new ecrdeploy.DockerImageName('javacs3/nginx:latest', 'arn:aws:secretsmanager:us-west-2:000000000000:secret:id'),    dest=ecrdeploy.DockerImageName(f&quot;{cdk.Aws.ACCOUNT_ID}.dkr.ecr.us-west-2.amazonaws.com/my-nginx3:latest&quot;)).add_to_principal_policy(iam.PolicyStatement(    effect=iam.Effect.ALLOW,    actions=[&quot;secretsmanager:GetSecretValue&quot;    ],    resources=[&quot;*&quot;]))```## Sample: [test/example.ecr-deployment.ts](./test/example.ecr-deployment.ts)```shell# Run the following command to try the sample.NO_PREBUILT_LAMBDA=1 npx cdk deploy -a &quot;npx ts-node -P tsconfig.dev.json --prefer-ts-exts test/example.ecr-deployment.ts&quot;```## [API](./API.md)## Tech Details &amp; ContributionThe core of this project relies on [containers/image](https://github.com/containers/image) which is used by [Skopeo](https://github.com/containers/skopeo).Please take a look at those projects before contribution.To support a new docker image source(like docker tarball in s3), you need to implement [image transport interface](https://github.com/containers/image/blob/master/types/types.go). You could take a look at [docker-archive](https://github.com/containers/image/blob/ccb87a8d0f45cf28846e307eb0ec2b9d38a458c2/docker/archive/transport.go) transport for a good start.To test the `lambda` folder, `make test`.</longdescription>
</pkgmetadata>