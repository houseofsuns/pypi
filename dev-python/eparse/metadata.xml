<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE pkgmetadata SYSTEM "http://www.gentoo.org/dtd/metadata.dtd">
<pkgmetadata>
	<maintainer type="person">
		<email>gentoo@houseofsuns.org</email>
		<name>Markus Walter</name>
	</maintainer>
	<longdescription>======eparse======.. image:: https://img.shields.io/pypi/v/eparse.svg        :target: https://pypi.python.org/pypi/eparse.. image:: https://img.shields.io/badge/License-MIT-blue.svg        :target: https://opensource.org/licenses/MIT        :alt: License: MITDescription===========Excel spreadsheet crawler and table parser for data extractionand querying.Features========* Command-line interface* Recursive Excel file discovery* Sub-tabular data extraction (logical tables)* SQLite and PostgreSQL database interfaces* CLI query tool* Summary data metricsInstallation============To install eparse, you can use pip and the latest version on PyPI:.. code-block:: bash   $ pip install eparseOr you can clone this repo and install from source:.. code-block:: bash   $ git clone https://github.com/ChrisPappalardo/eparse.git   $ cd eparse   $ pip install .If you plan to use the postgres interface, you also need to installthe postgres package ``psycopg2``. Instructions can be found`here &lt;https://www.psycopg.org/docs/install.html#quick-install&gt;`_.This package is optional, and you can use the other interfacessuch as the ``SQLite3`` interface without having to install``psycopg2``.The easiest way to install the ``psycopg2`` package for yourparticular environment may be to install the pre-compiledbinary driver as follows:.. code-block:: bash   $ pip install psycopg2-binaryIf you see an error while trying to use a postgres endpoint suchas ``postgres://user:pass@host:port/my_db`` that mentions thepostgres driver is missing, then you know you haven't properlyinstalled (and compiled)  ``psycopg2``.Usage=====eparse can be used as either a python library or from the command-line.You can view supported CLI commands and usage with ``--help`` as follows:.. code-block:: bash    $ eparse --help    Usage: eparse [OPTIONS] COMMAND [ARGS]...    excel parser    Options:    -i, --input TEXT   input source    -o, --output TEXT  output destination    -f, --file TEXT    file(s) or dir(s) to target    -d, --debug        use debug mode    -l, --loose        find tables loosely    -r, --recursive    find files recursively    -t, --truncate     truncate dataframe output    -v, --verbose      increase output verbosity    --help             Show this message and exit.    Commands:    migrate  migrate eparse table    parse    parse table(s) found in sheet for target(s)    query    query eparse output    scan     scan for excel files in targetYou can also use eparse from python like so:.. code-block:: python    from eparse.core import get_df_from_file    print([table for table in get_df_from_file('myfile.xlsx')])    102   Date  Principal Repayment   Date  Principal Repayment    103  44834        700757.679004  44926        430013.148303    104  44926         71957.776108  45016        100576.127808    105  45016         147578.19262  45107        898008.340095    106  45107         32801.363072  45199         841656.13896    ...Scan----To scan one or more directories for Excel files with descriptiveinformation, you can use the ``scan`` command like so:.. code-block:: bash    $ eparse -v -f &lt;path_to_files&gt; scanIncrease the verbosity with additional flags, such as ``-vvv``, formore descriptive information about the file(s), including sheet names.Parse-----Excel files can be parsed as follows:.. code-block:: bash    $ eparse -v -f &lt;path_to_files&gt; parseThis mode will list each table found in each Excel file to the command-line.This mode is useful for initial discovery for parseable data.eparse uses a simple algorithm for identifying tables.  Table &quot;corners&quot;are identified as cells that contain empty cells above and to the right(or sheet boundaries).  A densely or sparsely populated 2x2 table mustfollow in order for data to be extracted in relation to that cell.eparse will automatically adjust for rowspan labels and empty tablecorners and the dense vs. sparse criterion can be controlled withthe ``--loose`` flag.eparse was written to accomodate various types of output formats andendpoints, including ``null:///``, ``stdout:///``, ``sqlite3:///db_name``,and ``postgres://user:password@host:port/db_name``.null^^^^This mode is useful for validating files and generating descriptiveinfo, and is the default.  The command above with `-v` is an exampleof this mode, which lists out the tables found.stdout^^^^^^This mode is good for viewing data extracted from Excel files in theconsole.  For example, you could view all tables found in `Sheet1`with the following command:.. code-block:: bash    $ eparse -f &lt;path_to_files&gt; -o stdout:/// parse -s &quot;Sheet1&quot;eparse uses `pandas &lt;https://github.com/pandas-dev/pandas&gt;`_to handle table data.  You can view larger tables without truncationusing the ``-t`` flag as follows:.. code-block:: bash    $ eparse -t -f &lt;path_to_files&gt; -o stdout:/// parse -s &quot;Sheet1&quot;Data in table format is useful for human viewing, but a serializedform is better for data interfacing.  Serialize your output withthe ``-z`` flag as follows:.. code-block:: bash    $ eparse -t -f &lt;path_to_files&gt; -o stdout:/// parse -zEach cell of extracted table data is serialized as follows:* `row` - 0-indexed table row number* `column` - 0-indexed table column number* `value` - the value of the cell as a ``str``* `type` - the implied python ``type`` of the data found* `c_header` - the column header* `r_header` - the row header* `excel_RC` - the RC reference from the spreadsheet (e.g. B10)* `sheet` - the name of the sheet* `f_name` - the name of the filesqlite3^^^^^^^eparse uses the `peewee &lt;https://github.com/coleifer/peewee&gt;`_package for ORM and database integration.  The`interfaces &lt;eparse/interfaces.py&gt;`_ module contains an``ExcelParse`` model that provides data persistence and a commoninterface.To create a `SQLite3 &lt;https://github.com/sqlite/sqlite&gt;`_ databasewith your parsed Excel data, use the following command:.. code-block:: bash    $ mkdir .files    $ eparse -f &lt;path_to_files&gt; -o sqlite3:/// parse -zThis command will automatically generate a unique database filenameusing the ``uuid`` python package in the ``.files/`` sub-directoryof the working directory.  You may need to create this directorybefore running this command, as shown.You can also specify a path and filename of your choosing, like so:.. code-block:: bash    $ mkdir .files    $ eparse -f &lt;path_to_files&gt; -o sqlite3:///path/filename.db parse -zpostgres^^^^^^^^eparse also supports `postgresql` integrations. As mentioned above,you will need ``psycopg2`` installed for `postgresql` integrationsto work. The eparse ``BaseDatabaseInterface`` abstracts theimplementation details, so you would use this interface the sameway you use the others, with the exception of the endpoint.To use a ``postgresql`` database as the source and/or destinationof your data, you would supply an ``--input`` and/or ``--output``endpoint to the tool as follows:.. code-block:: bash    $ eparse -o postgres://user:password@host:port/db_name ...Where details like ``user``, ``host``, ``port`` are provided toyou by your db administrator. eparse will create the necessarytable(s) and indexes for you when inserting data into the database.Query-----Once you have stored parsed data, you can begin to query it using the``peewee`` ORM.  This can be done with the tool or directly withthe database.For example, query distinct column header names from a generated``SQLite3`` database as follows:.. code-block:: bash    $ eparse -i sqlite3:///.files/&lt;db_file&gt; -o stdout:/// query -m get_c_header                   c_header  Total Rows  Data Types  Distinct Values      0             ABC-col         150           2               76      1             DEF-col        3981           3               15      2             GHI-col          20           1                2      ..                ...         ...         ...              ...This command will give descriptive information of each distinct c_headerfound, including total rows, unique data types, and distinct values.You can also get raw un-truncated data as follows:.. code-block:: bash    $ eparse -t -i sqlite3:///.files/&lt;db_file&gt; -o stdout:/// queryFiltering data on content is easy.  Use the ``--filter`` option asfollows:.. code-block:: bash    $ eparse -i sqlite3:///.files/&lt;db_file&gt; -o stdout:/// query --filter f_name &quot;somefile.xlsx&quot;The above command will filter all rows from an Excel file named`somefile.xlsx`. You can use any of the following ``django``-stylefilters:* ``__eq`` equals X* ``__lt`` less than X* ``__lte`` less than or equal to X* ``__gt`` greater than X* ``__gte`` greater than or equal to X* ``__ne`` not equal to X* ``__in`` X is in* ``__is`` is X* ``__like`` like expression, such as ``%somestr%``, case sensitive* ``__ilike`` like expression, such as ``%somestr%``, case insensitive* ``__regexp`` regular expression matching such as ``^.*?foo.*?$``Filters are applied to the ORM fields like so:* ``--filter row__gte 4`` all extracted table rows `&gt;= 5`* ``--filter f_name__ilike &quot;%foo%&quot;`` all data from filenames with `foo`* ``--filter value__ne 100`` all data with values other than `100`Queried data can even be stored into a new database for creatingcurated data subsets, as follows:.. code-block:: bash    $ eparse -i sqlite3:///.files/&lt;db_file&gt; \             -o sqlite3:///.files/&lt;subq_db_file&gt; \             query --filter f_name &quot;somefile.xlsx&quot;Since database files the tool generates when using `sqlite3:///` are``SQLite`` native, you can also use `SQLite` database client toolsand execute raw SQL like so:.. code-block:: bash    $ sudo apt-get install -y sqlite3-tools    $ sqlite3 .files/&lt;db_file&gt;    SQLite version 3.37.2 2022-01-06 13:25:41    Enter &quot;.help&quot; for usage hints.    sqlite&gt; .schema    CREATE TABLE IF NOT EXISTS &quot;excelparse&quot; (&quot;id&quot; INTEGER NOT NULL PRIMARY KEY, &quot;row&quot; INTEGER NOT NULL, &quot;column&quot; INTEGER NOT NULL, &quot;value&quot; VARCHAR(255) NOT NULL, &quot;type&quot; VARCHAR(255) NOT NULL, &quot;c_header&quot; VARCHAR(255) NOT NULL, &quot;r_header&quot; VARCHAR(255) NOT NULL, &quot;excel_RC&quot; VARCHAR(255) NOT NULL, &quot;name&quot; VARCHAR(255) NOT NULL, &quot;sheet&quot; VARCHAR(255) NOT NULL, &quot;f_name&quot; VARCHAR(255) NOT NULL);    sqlite&gt; .header on    sqlite&gt; SELECT * FROM excelparse LIMIT 1;    id|row|column|value|type|c_header|r_header|excel_RC|name|sheet|f_name    1|0|0|ABC|&lt;class 'str'&gt;|SomeCol|SomeRow|B2|MyTable|Sheet1|myfile.xlsmMigrate-------eparse wouldn't be a solid tool without the ability to migrate youreparse databases for future code changes.  You can apply migrationsthat ship with future versions of eparse as follows:.. code-block:: bash    $ eparse -i sqlite3:///.files/&lt;db_file&gt; migrate -m &lt;migration&gt;    applied &lt;migration&gt;It is up to you to determine the migrations you need based on theeparse version you are upgrading from and to. Migrations can befound in `eparse/migrations.py &lt;eparse/migrations.py&gt;`_Unstructured============If you would like to use eparse to partition xls[x] files alongside unstructured, you can do so with our contributed `partition` and `partition_xlsx` modules. Simply import the `partition` function from `eparse.contrib.unstructured.partition` and use it instead of `partition` from `unstructured.partition.auto` like so:.. code-block:: python    from eparse.contrib.unstructured.partition import partition    elements = partition(filename='some_file.xlsx', eparse_mode='...')Valid `eparse_mode` settings are available in `eparse.contrib.unstructured.xlsx._eparse_modes`.Contributing============As an open-source project, contributions are always welcome. Please see `Contributing &lt;CONTRIBUTING.rst&gt;`_ for more information.License=======eparse is licensed under the `MIT License &lt;https://opensource.org/licenses/MIT&gt;`_. See the `LICENSE &lt;LICENSE&gt;`_ file for more details.Contact=======Thanks for your support of eparse. Feel free to contact me at `cpappala@gmail.com &lt;mailto:cpappala@gmail.com&gt;`_ or connect with me on `Github &lt;https://www.linkedin.com/in/chris-a-pappalardo/&gt;`_.=======History=======0.7.3 (2023-08-23)==================* Updated partition and partition_xlsx for latest unstructured0.7.2 (2023-08-22)==================* Relaxed unstructured dependency requirement for compatibility0.7.1 (2023-08-20)==================* Added unstructured contrib to core package* Uopdaed README with instructions0.7.0 (2023-08-18)==================* Added html conversion functions and an html data interface* Added get_table_digest to core0.6.3 (2023-06-30)==================* Updated get_df_from_file to accept filename or io object0.6.1 (2023-06-22)==================* Added get_df_from_file helper function* Added contrib with unstructured partition handler0.5.0 (2023-06-14)==================* Optimized database interfaces0.4.0 (2023-06-14)==================* Added postgresql interface0.3.0 (2023-06-14)==================* Added inteface classes* Added migrations0.2.0 (2023-06-12)==================* Added migrate command* Added 0.1.2 to 0.2.0 migration0.1.2 (2023-06-07)==================* Updated README0.1.1 (2023-06-06)==================* Updated requirements* Updated README0.1.0 (2023-06-06)==================* First release on PyPI.</longdescription>
</pkgmetadata>