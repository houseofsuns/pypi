<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE pkgmetadata SYSTEM "http://www.gentoo.org/dtd/metadata.dtd">
<pkgmetadata>
	<maintainer type="person">
		<email>gentoo@houseofsuns.org</email>
		<name>Markus Walter</name>
	</maintainer>
	<longdescription>.. -*- coding: utf-8 -*-============= CwClientLib=============Summary-------A Python library to easily build CubicWeb_ clients:* execute RQL_ queries remotely (using rqlcontroller_),* access instances that requires authentication (using signedrequest_).It also provides a simple command line tool (cwrql) to execute simple requests.Requirements------------client side:- requests_ (&gt;= 2.0)server side:- CubicWeb (&gt;= 3.18.3) with the cubes rqlcontroller_ and signedrequest_Configuration-------------``cwclientlib`` implements a ``cwproxy_for(instance)`` function thatwill build a ``CWProxy`` for the given instance, readingauthentication credentials from a configuration file (can be a inifile, json or yaml). The default configuration file name is`~/.config/cwclientlibrc` (using the ini file format), but this can bechanged using the ``CWCLCONF`` environment variable. For example:.. code-block:: bash   david@perseus:~$ cat ~/.config/cwclientlibrc   [cwo]   url = https://www.cubicweb.org/   token-id = my_cwo_token   secret = &lt;my-secret&gt;   [elo]   url = https://www.logilab.org   token-id = my_elo_token   secret = &lt;my-secret&gt;makes it possible to write:.. code-block:: bash   david@perseus:~$ cwrql cwo &quot;Any N,S WHERE P eid 1251664, P name N, P summary S&quot;   projman a project management tool   david@perseus:~$ cwrql -v ejsonexport -j cwo &quot;Any P WHERE P eid 1251664&quot;   [{&quot;description&quot;: &quot;It reads project descriptions [...]&quot;,   &quot;modification_date&quot;: &quot;2015/02/13 18:12:40&quot;,   &quot;icon_format&quot;: null,   &quot;description_format&quot;: &quot;text/rest&quot;,   &quot;summary&quot;: &quot;a project management tool&quot;,   &quot;downloadurl&quot;: &quot;http://download.logilab.org/pub/projman&quot;,   &quot;cwuri&quot;: &quot;http://www.logilab.org/873&quot;,   &quot;__cwetype__&quot;: &quot;Project&quot;,   &quot;eid&quot;: 1251664,   &quot;creation_date&quot;: &quot;2006/09/28 17:44:38&quot;,   &quot;homepage&quot;: null,   &quot;debian_source_package&quot;: null,   &quot;name&quot;: &quot;projman&quot;}]or:.. code-block:: python   from cwclientlib import cwproxy_for   client = cwproxy_for('cwo')   # or client = cwproxy_for('https://www.cubicweb.org/')   query = 'Any X WHERE X is Ticket, X concerns P, P name &quot;cwclientlib&quot;'   resp = client.rql(query)   data = resp.json()Note that the config file may contain credentials, so its permissionsmust be readable only by the user (checked on posix platforms only).Using signed requests---------------------Once the cube signedrequest_ is added, in the WebUI:#. View a ``CWUser`` and click the action ``add an AuthToken``#. Give an identifier to the token and make it enabled#. Use the token identifier and the token in your source codeConfiguration-------------You can define url and credentials for commonly used cubicwebendpoints in a config file. By default, on Linux, it will be a inifile located at ``$HOME/.config/cwclientlibrc`` but you may define the``CWCLCONF`` environmentvariable to specify it.  This config file canalso be a YAML (file name must end with .yaml) or a JSON file (.json).The file will look like:.. code-block:: ini   [cwo]   url = https://www.cubicweb.org/   token-id = my token id   secret = &lt;my secret&gt;Command line tools------------------cwclientlib comes with 3 simple command-line tools allowing to easilyrequest a cubicweb application from a shell:`cwrql` to make RQL queries:.. code-block:: bash   david@perseus:~$ cwrql -h   Usage: cwrql [options] (url|instance_id) rqlquery [rqlquery2] ...   Options:     -h, --help         show this help message and exit     -j, --json         produce JSON data     -v VID, --vid=VID  vid to use (default is jsonexport)     -S, --no-ssl       do NOT verify ssl server certificate; ignored if --ca is                        given     -c CA, --ca=CA     Bundle CA to use to verify server certificate     -w, --rqlio        use rqlio   david@perseus:~$ cwrql  cwo  &quot;Any VN, VS WHERE V version_of P,   &gt; P name 'cwclientlib', V num VN, V in_state S, S name VS&quot;   0.2.1 published   0.3.0 dev   0.2.0 published   0.1.0 published`cwget` to make any king of GET request (ie. call a specific cubicweb controller):.. code-block:: bash   david@perseus:~$ cwget cwo /testconfig/1251730 \   vid=apycot.get_configuration  environment=4209277   [{&quot;pylint_threshold&quot;: &quot;7&quot;, &quot;install&quot;: &quot;python_setup&quot;, &quot;pycoverage_threshold&quot;: &quot;70&quot;}]`cwshell` to connect to a cubicweb endopint and start an interactivepython shell with a few additional builtins ``rql`` and``client``. This shell also provides RQL auto-completion:.. code-block:: bash   david@perseus:~$ cwshell cwo   You are connected to https://www.cubicweb.org   &gt;&gt;&gt; client.execute('Any X WHERE X is P   Patch               Plan                Project             ProjectEnvironment   &gt;&gt;&gt; rql('Any P, N WHERE X is Project, X name P ,V version_of X, V in_state S, V num N, S name &quot;ready&quot;')   [[u'cubicweb-pyramid', u'0.2.0'], [u'cubicweb-simplefacet', u'0.3.2']]   &gt;&gt;&gt;Available extra builtins::client: is the CWProxy instance connected to the cubicweb endpoint.:rql: shortcut for ``client.execute()``.Python examples---------------Simple read only query:.. code-block:: python   from cwclientlib import cwproxy   client = cwproxy.CWProxy('http://www.cubicweb.org/')   query = 'Any X WHERE X is Ticket, X concerns P, P name &quot;cwclientlib&quot;'   resp = client.rql(query)   data = resp.json()Creating an entity, authenticating with signedrequest_ withcredentials read from the config file:.. code-block:: python   from cwclientlib import cwproxy_for   client = cwproxy_for('cwo')   queries = [('INSERT CWUser U: U login %(l)s, U upassword %(p)s',               {'l': 'Babar', 'p': 'cubicweb rulez &amp; 42'}), ]   resp = client.rqlio(queries)   data = resp.json()Creating an entity, authenticating with signedrequest_ building theauthentifier by hand:.. code-block:: python   from cwclientlib import cwproxy   auth = cwproxy.SignedRequestAuth('my token', '6ed44d82172211e49d9777269ec78bae')   client = cwproxy.CWProxy('https://www.cubicweb.org/', auth)   queries = [('INSERT CWUser U: U login %(l)s, U upassword %(p)s',               {'l': 'Babar', 'p': 'cubicweb rulez &amp; 42'}), ]   resp = client.rqlio(queries)   data = resp.json()Creating a file entity, authenticating with signedrequest_:.. code-block:: python   from io import BytesIO   from cwclientlib import cwproxy_for   client = cwproxy_for('cwo')   queries = [('INSERT File F: F data %(content)s, F data_name %(fname)s',               {'content': BytesIO('some binary data'), 'fname': 'toto.bin'})]   resp = client.rqlio(queries)   data = resp.json().. _CubicWeb: http://www.cubicweb.org/.. _RQL: http://docs.cubicweb.org/annexes/rql/language.. _rqlcontroller: http://www.cubicweb.org/project/cubicweb-rqlcontroller/.. _signedrequest: http://www.cubicweb.org/project/cubicweb-signedrequest/.. _requests: http://docs.python-requests.org/en/latest/</longdescription>
</pkgmetadata>